const annotationsTrack = document.getElementsByTagName("annotations-track")[0];

// const xmlData = `<?xml version="1.0" encoding="UTF-8" ?><document>    <annotations itct="CAAQwOYBIhMIzeXT9ZeR3wIVwl_tCh2U9gLjKPgdMgJpdki-teuEj7LpgFg">        <annotation id="annotation_1051749099" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_1051749099" itct="CAEQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>Hello, and welcome back to Super Marisa World! Wow, I&#39;m just inches away from the 5-million mark!</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="39.58300" y="0.00000" w="60.41700" h="10.83300" t="0:01.000" />                    <rectRegion x="39.58300" y="0.00000" w="60.41700" h="10.83300" t="0:06.000" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="0" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>        <annotation id="annotation_1051949131" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_1051949131" itct="CAIQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>So, every time I hit Meiling, the number of green guys to show up increases by 1. This is gonna get hectic fast!</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="17.50000" y="89.16700" w="65.20800" h="11.11100" t="4:21.500" />                    <rectRegion x="17.50000" y="89.16700" w="65.20800" h="11.11100" t="4:26.500" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="0" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>        <annotation id="annotation_1102984049" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_1102984049" itct="CAMQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>Pipe #13...</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="41.04200" y="93.61100" w="15.20800" h="6.66600" t="1:32.000" />                    <rectRegion x="41.04200" y="93.61100" w="15.20800" h="6.66600" t="1:35.000" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="0" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>        <annotation id="annotation_1240592055" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_1240592055" itct="CAQQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>SPLOOSH!</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="59.37500" y="93.61100" w="15.62500" h="6.66600" t="4:49.451" />                    <rectRegion x="59.37500" y="93.61100" w="15.62500" h="6.66600" t="4:51.000" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="0" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>        <annotation id="annotation_14343865" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_14343865" itct="CAUQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>Whoa, very close call there! ...But, I&#39;m still in this room...</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="17.50000" y="93.61100" w="65.41700" h="6.66600" t="0:56.000" />                    <rectRegion x="17.50000" y="93.61100" w="65.41700" h="6.66600" t="1:00.000" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="0" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>        <annotation id="annotation_157657569" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_157657569" itct="CAYQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>I got punished because you snuck in again.</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="47.91700" y="93.61100" w="52.08300" h="6.66600" t="3:21.000" />                    <rectRegion x="47.91700" y="93.61100" w="52.08300" h="6.66600" t="3:27.000" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="9902361" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>        <annotation id="annotation_1617201327" type="text" style="popup" log_data="a-v=WAGlkPCa2r4&amp;xble=1&amp;a-type=1&amp;ei=3TgMXI2DK8K_tQeU7YuYDg&amp;a-id=annotation_1617201327" itct="CAcQs-UBGP___________wEiEwjN5dP1l5HfAhXCX-0KHZT2AuMo-B0yAml2SL6164SPsumAWA">            <TEXT>So~meo~ne He~lp me~</TEXT>            <segment>                <movingRegion type="rect">                    <rectRegion x="69.16700" y="93.05600" w="30.83300" h="6.94400" t="2:53.500" />                    <rectRegion x="69.16700" y="93.05600" w="30.83300" h="6.94400" t="2:57.000" />                </movingRegion>            </segment>            <appearance bgAlpha="0.600000023842" bgColor="9902361" fgColor="16777215" textSize="3.3098083333333332" effects="">            </appearance>        </annotation>    </annotations></document>`;
const xmlData = `<?xml version="1.0" encoding="UTF-8" ?><document><annotations itct="CAAQwOYBIhMIuoGx5aPs3wIVFqSCCh3oDgNoKPgdMgJpdkiUutLEh7G6unM"><annotation id="annotation_12785543" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_12785543&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D11s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAEQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="24.88100" y="75.04200" w="25.24600" h="24.95800" t="0:00.000"/>      <rectRegion x="24.88100" y="75.04200" w="25.24600" h="24.95800" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_12785543&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=11s" link_class="1"/>  </action></annotation><annotation id="annotation_175227803" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_175227803&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D1m24.2s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAIQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="49.92100" y="24.78900" w="25.24600" h="25.22500" t="0:00.000"/>      <rectRegion x="49.92100" y="24.78900" w="25.24600" h="25.22500" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_175227803&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=1m24.2s" link_class="1"/>  </action></annotation><annotation id="annotation_1997416705" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_1997416705&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAMQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">  <TEXT>Back to menu</TEXT>  <segment>    <movingRegion type="rect">      <rectRegion x="0.00000" y="0.00000" w="22.06800" h="7.76100" t="0:10.000"/>      <rectRegion x="0.00000" y="0.00000" w="22.06800" h="7.76100" t="2:16.602"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="4.814266666666667" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_1997416705&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ" link_class="1"/>  </action></annotation><annotation id="annotation_3224996515" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_3224996515&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D1m40.8s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAQQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="24.88100" y="0.00000" w="25.23800" h="24.94400" t="0:00.000"/>      <rectRegion x="24.88100" y="0.00000" w="25.23800" h="24.94400" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_3224996515&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=1m40.8s" link_class="1"/>  </action></annotation><annotation id="annotation_3493128523" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_3493128523&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D1m58.6s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAUQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="49.92100" y="0.00000" w="25.24600" h="25.22500" t="0:00.000"/>      <rectRegion x="49.92100" y="0.00000" w="25.24600" h="25.22500" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_3493128523&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=1m58.6s" link_class="1"/>  </action></annotation><annotation id="annotation_3589569011" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_3589569011&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D27.2s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAYQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="49.76200" y="74.76100" w="25.40400" h="25.23900" t="0:00.000"/>      <rectRegion x="49.76200" y="74.76100" w="25.40400" h="25.23900" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_3589569011&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=27.2s" link_class="1"/>  </action></annotation><annotation id="annotation_3747833239" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_3747833239&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DkewlFw1LN3Y&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAcQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">  <TEXT>Back to HUB</TEXT>  <segment>    <movingRegion type="rect">      <rectRegion x="0.00000" y="0.00000" w="20.95900" h="7.76100" t="0:00.000"/>      <rectRegion x="0.00000" y="0.00000" w="20.95900" h="7.76100" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="4.814266666666667" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_3747833239&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=kewlFw1LN3Y" link_class="1"/>  </action></annotation><annotation id="annotation_4196429415" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_4196429415&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D1m3.5s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAgQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="24.88100" y="24.78900" w="25.24600" h="25.50700" t="0:00.000"/>      <rectRegion x="24.88100" y="24.78900" w="25.24600" h="25.50700" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_4196429415&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=1m3.5s" link_class="1"/>  </action></annotation><annotation id="annotation_513931247" type="text" style="popup" log_data="a-v=c3TpiHiUnRQ&amp;l-class=1&amp;a-id=annotation_513931247&amp;xble=1&amp;link=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dc3TpiHiUnRQ%23t%3D46s&amp;a-type=1&amp;ei=IPs7XLrxPJbIigTonYzABg" itct="CAkQs-UBGP___________wEiEwi6gbHlo-zfAhUWpIIKHegOA2go-B0yAml2SJS60sSHsbq6cw">    <segment>    <movingRegion type="rect">      <rectRegion x="37.40100" y="49.85900" w="25.24600" h="25.22500" t="0:00.000"/>      <rectRegion x="37.40100" y="49.85900" w="25.24600" h="25.22500" t="0:10.000"/>    </movingRegion>  </segment>  <appearance bgAlpha="0.25" bgColor="0" fgColor="16777215" textSize="3.911599999999999" effects="">      </appearance>    <action type="openUrl" trigger="click">    <url target="current" value="https://www.youtube.com/watch?annotation_id=annotation_513931247&amp;ei=IPs7XLrxPJbIigTonYzABg&amp;feature=iv&amp;src_vid=c3TpiHiUnRQ&amp;v=c3TpiHiUnRQ#t=46s" link_class="1"/>  </action></annotation></annotations></document>`;

const parser = new AnnotationParser();
const annotationElements = parser.getAnnotationsFromXml(xmlData);
const annotations = parser.parseYoutubeAnnotationList(annotationElements);

const videoContainer = document.getElementById("vid-cont");

const optionsForm = document.getElementById("options-form");

const video = document.getElementById("vid");
const renderer = new AnnotationRenderer(annotations, videoContainer, {
    getVideoTime() {
        return video.currentTime;
    },
    seekTo(seconds) {
        video.currentTime = seconds;
    },
    getOriginalVideoWidth() {
        return video.videoWidth;
    },
    getOriginalVideoHeight() {
        return video.videoHeight;
    }
});
renderer.start();

const propsEditor = new PropEditor(optionsForm, parser, renderer);

// window.addEventListener("resize", e => {
//     renderer.updateAllAnnotationSizes();
// });

function sortAnnotationsByStartTime(annotations) {
    return annotations.sort((a, b) => {
        if (a.timeStart > b.timeStart) {
            return true;
        }
        else if (a.timeStart === b.timeStart) {
            return a.timeEnd > b.timeEnd ? true : false;
        }
        else {
            return false;
        }
    });
}

document.addEventListener("DOMContentLoaded", e => {

    // const annotations = [
    //     {timeStart: 0, timeEnd: 5, text: "first", style: "speech"},
    //     {timeStart: 6, timeEnd: 10, text: "second", style: "speech"},
    //     // {timeStart: 6, timeEnd: 18, text: "third", style: "speech"},
    //     {timeStart: 0, timeEnd: 3, text: "fourth", style: "speech"}
    // ]

    // console.log(sortAnnotationsByStartTime(annotations));

    annotationsTrack.setRenderer(renderer);
    annotationsTrack.setEditor(propsEditor);
    annotationsTrack.createAnnotationsFromRenderer();
    // annotationsTrack.addAnnotationList(annotations);
});